{"ast":null,"code":"var _jsxFileName = \"/Users/cyfi/Downloads/splunk-sdk-javascript-create-react-app/examples/browser/create-splunk-react-app/src/SplunkJsExample.js\";\nimport React from 'react';\nimport './SplunkJsExample.css';\nimport Inputs from './Inputs';\nimport * as splunkjs from 'splunk-sdk'; // jquery.ajax is used for the underlying http client in ProxyHttp\n\nwindow.$ = require('jquery'); //const splunkjs = require('splunk-sdk');\n\nconst Async = splunkjs.Async;\n\nconst clientHttp = require('splunk-sdk/lib/platform/client/proxy_http');\n\nclass SplunkJsExample extends React.Component {\n  constructor(props) {\n    super(props); // We define handlers here as well as Inputs.js in order to lift\n    // the username and password states up so that they can be used\n    // here to run and populate search results.\n    // More info on lifting state: https://reactjs.org/docs/lifting-state-up.html\n\n    this.handleUsernameChange = this.handleUsernameChange.bind(this);\n    this.handlePasswordChange = this.handlePasswordChange.bind(this);\n    this.handleQueryChange = this.handleQueryChange.bind(this);\n    this.handleSearch = this.handleSearch.bind(this);\n    this.generateError = this.generateError.bind(this);\n    this.state = {\n      username: 'admin',\n      password: 'adminuser',\n      query: 'search index=_internal | head 3',\n      results: []\n    };\n  }\n\n  handleUsernameChange(username) {\n    this.setState({\n      username: username\n    });\n  }\n\n  handlePasswordChange(password) {\n    this.setState({\n      password: password\n    });\n  }\n\n  handleQueryChange(query) {\n    this.setState({\n      query: query\n    });\n  }\n\n  handleSearch() {\n    var http = new clientHttp.ProxyHttp('/proxy');\n    var service = new splunkjs.Service(http, {\n      username: this.state.username,\n      password: this.state.password,\n      scheme: 'https',\n      // we have configured this example for HTTPS\n      host: 'localhost',\n      // this is the host for our http-proxy-middleware server, do not change\n      port: '3000' // this is the port for our http-proxy-middleware server, do not change\n\n    });\n    var that = this;\n    Async.chain([// First, we log in\n    function (done) {\n      service.login(done);\n    }, // Perform the search\n    function (success, done) {\n      if (!success) {\n        done('Error logging in');\n      }\n\n      service.search(`${that.state.query}`, {}, done);\n    }, // Wait until the job is done\n    function (job, done) {\n      job.track({}, function (job) {\n        // Ask the server for the results\n        job.results({}, done);\n      });\n    }, // Print out the statistics and get the results\n    function (results, job, done) {\n      // Print out the statistics to the console\n      console.log('Splunk Search Job Statistics:');\n      console.log(`  Event Count: ${job.properties().eventCount}`);\n      console.log(`  Disk Usage: ${job.properties().diskUsage} bytes`);\n      console.log(`  Priority: ${job.properties().priority}`);\n      console.log(results);\n      that.setState({\n        results: results\n      });\n    }], function (err) {\n      console.error(err);\n    });\n  }\n\n  generateError() {\n    var http = new clientHttp.ProxyHttp('/proxy');\n    var service = new splunkjs.Service(http, {\n      username: this.state.username,\n      password: this.state.password,\n      scheme: 'https',\n      // we have configured this example for HTTPS\n      host: 'localhost',\n      // this is the host for our http-proxy-middleware server, do not change\n      port: '3000' // this is the port for our http-proxy-middleware server, do not change\n\n    }); // Create a Logger Class for different Level\n\n    var Logger = splunkjs.Class.extend({\n      init: function (service, opts) {\n        this.service = service;\n        opts = opts || {};\n        this.params = {};\n        if (opts.index) this.params.index = opts.index;\n        if (opts.host) this.params.host = opts.host;\n        if (opts.source) this.params.source = opts.source;\n        if (opts.sourcetype) this.params.sourcetype = opts.sourcetype || \"react_error\";\n\n        if (!this.service) {\n          throw new Error(\"Must supply a valid service\");\n        }\n      },\n      log: function (data) {\n        var message = {\n          __time: new Date().toUTCString(),\n          level: \"LOG\",\n          data: data\n        };\n        this.service.log(message, this.params);\n        console.log(data);\n      },\n      error: function (data) {\n        var message = {\n          __time: new Date().toUTCString(),\n          level: \"ERROR\",\n          data: data\n        };\n        this.service.log(message, this.params);\n        console.error(data);\n      },\n      info: function (data) {\n        var message = {\n          __time: new Date().toUTCString(),\n          level: \"INFO\",\n          data: data\n        };\n        this.service.log(message, this.params);\n        console.info(data);\n      },\n      warn: function (data) {\n        var message = {\n          __time: new Date().toUTCString(),\n          level: \"WARN\",\n          data: data\n        };\n        this.service.log(message, this.params);\n        console.warn(data);\n      }\n    });\n    service.log(\"A new event\", {\n      index: \"react_error\",\n      sourcetype: \"poc\"\n    }, function (err, result) {\n      console.log(\"Submitted event: \", result);\n    }); // First, we log in\n\n    service.login(function (err, success) {\n      // We check for both errors in the connection as well\n      // as if the login itself failed.\n      if (err || !success) {\n        console.log(\"Login failure. Please check your server hostname and authentication credentials.\");\n        return;\n      } // Create our logger\n\n\n      var logger = new Logger(service, {\n        index: \"react_error\",\n        sourcetype: \"poc\"\n      }); // Log the various types of messages. Note how we are sending\n      // both strings and JSON objects, which will be auto-encoded and\n      // understood by Splunk 4.3+\n\n      logger.log(\"I LOGGED TO SPLUNK - look at your JS console!\");\n      logger.error(\"ERROR HAPPENED\");\n      logger.info([\"useful\", \"info\"]);\n      logger.warn({\n        \"this\": {\n          \"is\": [\"a\", \"warning\"]\n        }\n      });\n    });\n  }\n\n  render() {\n    const results = this.state.results; // Find the index of the fields we want\n\n    const timeIndex = (results.fields || []).indexOf('_time');\n    const sourceIndex = (results.fields || []).indexOf('source');\n    const sourcetypeIndex = (results.fields || []).indexOf('sourcetype');\n    const rawIndex = (results.fields || []).indexOf('_raw');\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"SplunkExample\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Inputs, {\n      username: this.state.username,\n      password: this.state.password,\n      query: this.state.query,\n      onUsernameChange: this.handleUsernameChange,\n      onPasswordChange: this.handlePasswordChange,\n      onQueryChange: this.handleQueryChange,\n      onClickGenerateError: this.generateError,\n      onClickSearch: this.handleSearch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(\"h3\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 13\n      }\n    }, \"Results\"), /*#__PURE__*/React.createElement(\"table\", {\n      className: \"Results\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 226,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 25\n      }\n    }, \"_time\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 39\n      }\n    }, \"source\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 54\n      }\n    }, \"sourcetype\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 73\n      }\n    }, \"_raw\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 17\n      }\n    }, (results.rows || []).map((result, i) => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: i.toString(),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 32\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 55\n        }\n      }, result[timeIndex]), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 83\n        }\n      }, result[sourceIndex]), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 113\n        }\n      }, result[sourcetypeIndex]), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 147\n        }\n      }, result[rawIndex]));\n    }), /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 21\n      }\n    }))));\n  }\n\n}\n\nexport default SplunkJsExample;","map":{"version":3,"sources":["/Users/cyfi/Downloads/splunk-sdk-javascript-create-react-app/examples/browser/create-splunk-react-app/src/SplunkJsExample.js"],"names":["React","Inputs","splunkjs","window","$","require","Async","clientHttp","SplunkJsExample","Component","constructor","props","handleUsernameChange","bind","handlePasswordChange","handleQueryChange","handleSearch","generateError","state","username","password","query","results","setState","http","ProxyHttp","service","Service","scheme","host","port","that","chain","done","login","success","search","job","track","console","log","properties","eventCount","diskUsage","priority","err","error","Logger","Class","extend","init","opts","params","index","source","sourcetype","Error","data","message","__time","Date","toUTCString","level","info","warn","result","logger","render","timeIndex","fields","indexOf","sourceIndex","sourcetypeIndex","rawIndex","rows","map","i","toString"],"mappings":"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","sourcesContent":["import React from 'react';\nimport './SplunkJsExample.css';\nimport Inputs from './Inputs';\nimport * as splunkjs from 'splunk-sdk';\n\n// jquery.ajax is used for the underlying http client in ProxyHttp\nwindow.$ = require('jquery');\n\n//const splunkjs = require('splunk-sdk');\nconst Async  = splunkjs.Async;\nconst clientHttp = require('splunk-sdk/lib/platform/client/proxy_http');\n\nclass SplunkJsExample extends React.Component {\n    constructor(props) {\n      super(props);\n      // We define handlers here as well as Inputs.js in order to lift\n      // the username and password states up so that they can be used\n      // here to run and populate search results.\n      // More info on lifting state: https://reactjs.org/docs/lifting-state-up.html\n      this.handleUsernameChange = this.handleUsernameChange.bind(this);\n      this.handlePasswordChange = this.handlePasswordChange.bind(this);\n      this.handleQueryChange = this.handleQueryChange.bind(this);\n      this.handleSearch = this.handleSearch.bind(this);\n      this.generateError = this.generateError.bind(this);\n      this.state = {\n          username: 'admin',\n          password: 'adminuser',\n          query: 'search index=_internal | head 3',\n          results: [],\n      };\n    }\n  \n    handleUsernameChange(username) {\n        this.setState({username: username});\n    }\n\n    handlePasswordChange(password) {\n        this.setState({password: password});\n    }\n\n    handleQueryChange(query) {\n        this.setState({query: query});\n    }\n\n    handleSearch() {\n        var http = new clientHttp.ProxyHttp('/proxy');\n        var service = new splunkjs.Service(http, {\n            username: this.state.username,\n            password: this.state.password,\n            scheme: 'https', // we have configured this example for HTTPS\n            host: 'localhost', // this is the host for our http-proxy-middleware server, do not change\n            port: '3000' // this is the port for our http-proxy-middleware server, do not change\n        });\n\n\n        var that = this;\n        Async.chain([\n        // First, we log in\n        function(done) {\n            service.login(done);\n        },\n        // Perform the search\n        function(success, done) {\n            if (!success) {\n                done('Error logging in');\n            }\n            \n            service.search(`${that.state.query}`, {}, done);\n\n        },\n        // Wait until the job is done\n        function(job, done) {\n            job.track({}, function(job) {\n                // Ask the server for the results\n                job.results({}, done);\n            });\n        },\n        // Print out the statistics and get the results\n        function(results, job, done) {\n            // Print out the statistics to the console\n            console.log('Splunk Search Job Statistics:');\n            console.log(`  Event Count: ${job.properties().eventCount}`);\n            console.log(`  Disk Usage: ${job.properties().diskUsage} bytes`);\n            console.log(`  Priority: ${job.properties().priority}`);\n            console.log(results);\n            that.setState({results: results});\n        }],\n        function(err) {\n            console.error(err);        \n        }\n        );\n    }\n\n    generateError() {\n\n    var http = new clientHttp.ProxyHttp('/proxy');\n            var service = new splunkjs.Service(http, {\n                username: this.state.username,\n                password: this.state.password,\n                scheme: 'https', // we have configured this example for HTTPS\n                host: 'localhost', // this is the host for our http-proxy-middleware server, do not change\n                port: '3000' // this is the port for our http-proxy-middleware server, do not change\n            });\n\n// Create a Logger Class for different Level\n\nvar Logger = splunkjs.Class.extend({\n    init: function(service, opts) {\n        this.service = service;\n\n        opts = opts || {};\n\n        this.params = {};\n        if (opts.index)      this.params.index      = opts.index;\n        if (opts.host)       this.params.host       = opts.host;\n        if (opts.source)     this.params.source     = opts.source;\n        if (opts.sourcetype) this.params.sourcetype = opts.sourcetype || \"react_error\";\n\n        if (!this.service) {\n            throw new Error(\"Must supply a valid service\");\n        }\n    },\n\n    log: function(data) {\n        var message = {\n            __time: (new Date()).toUTCString(),\n            level: \"LOG\",\n            data: data\n        };\n\n        this.service.log(message, this.params);\n        console.log(data);\n    },\n\n    error: function(data) {\n        var message = {\n            __time: (new Date()).toUTCString(),\n            level: \"ERROR\",\n            data: data\n        };\n\n        this.service.log(message, this.params);\n        console.error(data);\n    },\n\n    info: function(data) {\n        var message = {\n            __time: (new Date()).toUTCString(),\n            level: \"INFO\",\n            data: data\n        };\n\n        this.service.log(message, this.params);\n        console.info(data);\n    },\n\n    warn: function(data) {\n        var message = {\n            __time: (new Date()).toUTCString(),\n            level: \"WARN\",\n            data: data\n        };\n\n        this.service.log(message, this.params);\n        console.warn(data);\n    },\n});\n\n\nservice.log(\"A new event\", {index: \"react_error\", sourcetype: \"poc\"}, function(err, result) {\n                 console.log(\"Submitted event: \", result);\n            });\n\n            // First, we log in\n            service.login(function(err, success) {\n                // We check for both errors in the connection as well\n                // as if the login itself failed.\n                if (err || !success) {\n                    console.log(\"Login failure. Please check your server hostname and authentication credentials.\");\n\n                    return;\n                }\n\n                // Create our logger\n                var logger = new Logger(service, {index: \"react_error\", sourcetype: \"poc\"});\n\n                // Log the various types of messages. Note how we are sending\n                // both strings and JSON objects, which will be auto-encoded and\n                // understood by Splunk 4.3+\n                logger.log(\"I LOGGED TO SPLUNK - look at your JS console!\");\n                logger.error(\"ERROR HAPPENED\");\n                logger.info([\"useful\", \"info\"]);\n                logger.warn({\"this\": {\"is\": [\"a\", \"warning\"]}});\n\n\n            });\n\n\n\n    }\n  \n    render() {\n      const results = this.state.results;\n\n      // Find the index of the fields we want\n      const timeIndex = (results.fields || []).indexOf('_time');\n      const sourceIndex = (results.fields || []).indexOf('source');\n      const sourcetypeIndex = (results.fields || []).indexOf('sourcetype');\n      const rawIndex = (results.fields || []).indexOf('_raw');\n      \n      return (\n        <div className='SplunkExample'>\n            <Inputs\n\n                username={this.state.username}\n                password={this.state.password}\n                query={this.state.query}\n                onUsernameChange={this.handleUsernameChange} \n                onPasswordChange={this.handlePasswordChange}\n                onQueryChange={this.handleQueryChange}\n                onClickGenerateError = {this.generateError}\n                onClickSearch={this.handleSearch} />\n\n            \n            <h3>Results</h3>\n            <table className='Results'>\n                <thead>\n                    <tr><th>_time</th><th>source</th><th>sourcetype</th><th>_raw</th></tr>\n                </thead>\n                <tbody>\n                    {(results.rows || []).map((result, i) => {\n                        return <tr key={i.toString()}><td>{result[timeIndex]}</td><td>{result[sourceIndex]}</td><td>{result[sourcetypeIndex]}</td><td>{result[rawIndex]}</td></tr>;\n                    })}\n                    <tr></tr>\n                </tbody>\n            </table>\n        </div>\n        );\n    }\n  }\n\n  export default SplunkJsExample;"]},"metadata":{},"sourceType":"module"}